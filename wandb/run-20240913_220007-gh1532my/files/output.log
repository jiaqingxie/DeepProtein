

































100%|██████████████████████████████████████████████████████████████████████████████| 4158/4158 [01:11<00:00, 58.34it/s]



100%|████████████████████████████████████████████████████████████████████████████████| 520/520 [00:08<00:00, 58.21it/s]





100%|████████████████████████████████████████████████████████████████████████████████| 520/520 [00:08<00:00, 57.79it/s]
Protein Function Prediction Mode...
in total: 4158 proteins
encoding protein...
unique target sequence: 4158
Done.
Protein Function Prediction Mode...
in total: 520 proteins
encoding protein...
unique target sequence: 520
Done.
Protein Function Prediction Mode...
in total: 520 proteins
encoding protein...
unique target sequence: 520
Done.
Let's use 1 GPU!
--- Data Preparation ---
--- Go for Training ---
Traceback (most recent call last):
  File "E:\DeepPurposePlusPlus\train\beta.py", line 84, in <module>
    model.train(train, val, test, compute_pos_enc = False)
  File "E:\DeepPurposePlusPlus\ProB\ProteinPred.py", line 331, in train
    score = self.model(v_p)
  File "E:\anaconda3\envs\graph\lib\site-packages\torch\nn\modules\module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "E:\anaconda3\envs\graph\lib\site-packages\torch\nn\modules\module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "E:\DeepPurposePlusPlus\ProB\ProteinPred.py", line 49, in forward
    v_f = self.model_protein(v_P)
  File "E:\anaconda3\envs\graph\lib\site-packages\torch\nn\modules\module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "E:\anaconda3\envs\graph\lib\site-packages\torch\nn\modules\module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "E:\DeepPurposePlusPlus\ProB\encoders.py", line 592, in forward
    node_feats = self.gnn(node_feats)
  File "E:\anaconda3\envs\graph\lib\site-packages\torch\nn\modules\module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "E:\anaconda3\envs\graph\lib\site-packages\torch\nn\modules\module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "E:\anaconda3\envs\graph\lib\site-packages\dgl\nn\pytorch\gt\graphormer.py", line 116, in forward
    nfeat = self.attn(nfeat, attn_bias, attn_mask)
  File "E:\anaconda3\envs\graph\lib\site-packages\torch\nn\modules\module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "E:\anaconda3\envs\graph\lib\site-packages\torch\nn\modules\module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "E:\anaconda3\envs\graph\lib\site-packages\dgl\nn\pytorch\gt\biased_mha.py", line 150, in forward
    attn_weights = self.dropout(attn_weights)
  File "E:\anaconda3\envs\graph\lib\site-packages\torch\nn\modules\module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "E:\anaconda3\envs\graph\lib\site-packages\torch\nn\modules\module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "E:\anaconda3\envs\graph\lib\site-packages\torch\nn\modules\dropout.py", line 59, in forward
    return F.dropout(input, self.p, self.training, self.inplace)
  File "E:\anaconda3\envs\graph\lib\site-packages\torch\nn\functional.py", line 1295, in dropout
    return _VF.dropout_(input, p, training) if inplace else _VF.dropout(input, p, training)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.33 GiB. GPU